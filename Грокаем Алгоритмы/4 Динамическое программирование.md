Динамическое программирование - это решение сложных задачи путем их разбиения на подзадачи.

Разберем его через задачу с вором. У вора есть рюкзак емкостью 4 и он нашел 3 предмета разной стоимости: 
- магнитофон вес 4, стоимость $3000; 
- ноутбук вес 3, стоимость $2000;
- гитара вес 1, стоимость $1500.
Необходимо  собрать предметы максимальной стоимостью.

Какие варианты решения? 

**Перебором**

Перебрать все комбинации: пусто - $0; гитара - $1500; магнитофон - $3000; ноутбук -  $2000; гитара+магнитофон - не помещается; гитара + ноутбук - $3500 ... и так далее.

Но это долго. Сложность растет по $O(2^n)$.

**Жадные (NP-полные) алгоритмы**

Такое решение не будет оптимальным, но будет быстрым.

Мы возьмем самый дорогой предмет, если останется место то возьмем следующий самый дорогой и так далее пока не закончиться место. В нашем случае мы возьмем только магнитофон, так как он заполнит весь рюкзак и является самым дорогим.

Сложность будет $O(n)$ , так как в худшем случае мы пройдемся по всем предметам.

**Динамическое программирование**

Возможно ли все-таки получить оптимальное решение за приемлемую сложность? Да, с помощью динамического программирования. В нашем случае мы будем решать задачу разбивая рюкзак на подрюкзаки. 

Для начала, строится таблица. Когда она будет полностью заполнена мы найдем решение.

| Предметы\Размеры   | 1   | 2   | 3   | 4   |
| ------------------ | --- | --- | --- | --- |
| Гитара 1/$1500     | -   | -   | -   | -   |
| Магнитофон 4/$3000 | -   | -   | -   | -   |
| Ноутбук 3/$2000    | -   | -   | -   | -   |

Далее мы должны заполнять каждую строчку сверху вниз слева направо. В каждую ячейку мы вносим (по определенной формуле, но про это позже) итоговую цену для текущего размера предмета или предметов. 

Для строки "Гитара" для размера один стоимость будет $1500 так как: гитара вмещается и это единственный предмет. И так далее для всех ячеек.

| Предметы\Размеры   | 1         | 2         | 3         | 4         |
| ------------------ | --------- | --------- | --------- | --------- |
| Гитара 1/$1500     | $1500 (Г) | $1500 (Г) | $1500 (Г) | $1500 (Г) |
| Магнитофон 4/$3000 | -         | -         | -         | -         |
| Ноутбук 3/$2000    | -         | -         | -         | -         |

Для строки "Магнитофон" интереснее. Для размера 1 Магнитофон не поместится, так как он большего размера, значит лучшем решением для этого же размера (самое дорогое) будет предыдущее - $1500 за гитару. И так далее до 4 размера. А на последнем Магнитофон уже вмещается, и он дороже предыдущего решения, поэтому в последнюю ячейку вписываем его. 

| Предметы\Размеры   | 1         | 2         | 3         | 4         |
| ------------------ | --------- | --------- | --------- | --------- |
| Гитара 1/$1500     | $1500 (Г) | $1500 (Г) | $1500 (Г) | $1500 (Г) |
| Магнитофон 4/$3000 | $1500 (Г) | $1500 (Г) | $1500 (Г) | $3000 (М) |
| Ноутбук 3/$2000    | -         | -         | -         | -         |
Для строки "Ноутбук" еще интереснее. Первые два размера будут также заполнены гитарой, так как ноутбук не вмещается. Далее для размера 3 - ноутбук является лучшем решением, так как дороже предыдущего (гитара за $1500).

И вот ключевой момент. Последняя ячейка. Варианты ее заполнения: 
- предыдущее решение - Магнитофон за $3000 без свободного места
- текущая строка - Ноутбук за $2000 с 1 одним свободным местом
Казалось бы, Магнитофон побеждает так как он дороже, но в случае с Ноутбуком у нас остается пустое место размером 1 и мы можем его использовать. Лучшее предыдущее решение для ячейки размером 1 - это гитара стоимостью $1500. Тогда, используя освободившееся место под гитару получаем еще один вариант:
- текущая строка - Ноутбук за $2000 + Гитара за $1500 размером 1 = $3500

| Предметы\Размеры   | 1         | 2         | 3         | 4           |
| ------------------ | --------- | --------- | --------- | ----------- |
| Гитара 1/$1500     | $1500 (Г) | $1500 (Г) | $1500 (Г) | $1500 (Г)   |
| Магнитофон 4/$3000 | $1500 (Г) | $1500 (Г) | $1500 (Г) | $3000 (М)   |
| Ноутбук 3/$2000    | $1500 (Г) | $1500 (Г) | $2000 (Н) | $3500 (Н+Г) |
Вот и получаем оптимальное решение.

Каждая ячейка тут рассчитывается по конкретной формуле:

![[Pasted image 20251110212905.png]]

### Упражнение

*Задача*: Предположим , к предметам добавился еще один: МРЗ-плеер. Он весит 1 фунт и стоит $1000. Стоит ли брать его?

Решение: Нужно добавить еще одну строку и дополнить таблицу 

| Предметы\Размеры   | 1         | 2         | 3         | 4           |
| ------------------ | --------- | --------- | --------- | ----------- |
| Гитара 1/$1500     | $1500 (Г) | $1500 (Г) | $1500 (Г) | $1500 (Г)   |
| Магнитофон 4/$3000 | $1500 (Г) | $1500 (Г) | $1500 (Г) | $3000 (М)   |
| Ноутбук 3/$2000    | $1500 (Г) | $1500 (Г) | $2000 (Н) | $3500 (Н+Г) |
| МРЗ-плеер 1/$1000  | -         | -         | -         | -           |
- Для размера 1 остается Гитара, так как она дороже плеера - это лучшее решение. 
- Для размера 2 лучшем решением является предыдущее - Гитара $1500, однако остается одно пустое место, которое можно использовать - МР3-плеер за $1000. Тогда в ячейке будет значение $2500.
- Для размера 3 лучшее предыдущее решение - это ноутбук за $2000, однако если использовать плеер и заполнить пустые 2 места лучшем предыдущим - Гитара за $1500, получим $2500, что дороже одного ноутбука. Тогда это значение пишем в ячейку.
- Финал: для размера 4 лучшее предыдущее значение $3500 ноутбук + гитара, если мы будем использовать только плеер, то останется 3 свободного времени. Предыдущее лучшее решение для размера  3 - это ноутбук. Получается $3000 Ноутбук + Плеер. Это меньше, чем предыдущее лучшее решение для размера 4, поэтому оставляем предыдущее.

| Предметы\Размеры   | 1         | 2           | 3           | 4           |
| ------------------ | --------- | ----------- | ----------- | ----------- |
| Гитара 1/$1500     | $1500 (Г) | $1500 (Г)   | $1500 (Г)   | $1500 (Г)   |
| Магнитофон 4/$3000 | $1500 (Г) | $1500 (Г)   | $1500 (Г)   | $3000 (М)   |
| Ноутбук 3/$2000    | $1500 (Г) | $1500 (Г)   | $2000 (Н)   | $3500 (Н+Г) |
| МРЗ-плеер 1/$1000  | $1500 (Г) | $2500 (Г+П) | $2500 (Г+П) | $3500 (Н+Г) |
Ответ: брать плеер не стоит.